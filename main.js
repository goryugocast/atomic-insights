/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

class AdamicAdar {
    constructor(app, settings) {
        this.app = app;
        this.settings = settings;
    }
    calculate(sourcePath) {
        const { resolvedLinks } = this.app.metadataCache;
        // 1. Build Graph & Filtering
        const exclusionList = this.settings.excludedFolders
            .split('\n')
            .map(s => s.trim())
            .filter(s => s.length > 0);
        const isExcluded = (path) => {
            return exclusionList.some(folder => path.startsWith(folder));
        };
        if (isExcluded(sourcePath)) ;
        const neighbors = {};
        const degrees = {};
        // Helper to add edge
        const addEdge = (u, v) => {
            if (!neighbors[u])
                neighbors[u] = new Set();
            if (!neighbors[v])
                neighbors[v] = new Set();
            neighbors[u].add(v);
            neighbors[v].add(u);
        };
        // Populate Graph
        // We only care about resolved links for now as unresolved files don't have back-links easily tracked without full scan
        // iterating source files
        for (const source in resolvedLinks) {
            if (isExcluded(source))
                continue;
            const targets = resolvedLinks[source];
            for (const target in targets) {
                if (isExcluded(target))
                    continue;
                addEdge(source, target);
            }
        }
        // Calculate degrees
        for (const node in neighbors) {
            degrees[node] = neighbors[node].size;
        }
        // 2. Algorithm
        const sourceNeighbors = neighbors[sourcePath];
        if (!sourceNeighbors)
            return [];
        const results = [];
        for (const targetNode in neighbors) {
            if (targetNode === sourcePath)
                continue;
            const targetNeighbors = neighbors[targetNode];
            let score = 0;
            const commonNodes = [];
            // Intersection
            sourceNeighbors.forEach(w => {
                if (targetNeighbors.has(w)) {
                    commonNodes.push(w);
                    const degree = degrees[w];
                    if (degree > 1) { // log(1) is 0, avoid division by zero if degree is 1 (though logic implies at least 2 if it connects two nodes)
                        score += 1 / Math.log(degree);
                    }
                }
            });
            if (score > 0) {
                results.push({
                    path: targetNode,
                    score: score,
                    commonNeighbors: commonNodes
                });
            }
        }
        // 2.5 Include Direct Links (Backlinks/Outgoing) if enabled
        if (this.settings.showBacklinks || this.settings.showOutgoingLinks) {
            // Re-fetch neighbors from the graph we built (it is undirected, so it includes both directions)
            const directNeighbors = neighbors[sourcePath];
            if (directNeighbors) {
                directNeighbors.forEach(targetPath => {
                    var _a, _b;
                    if (isExcluded(targetPath))
                        return;
                    // Check if already in results
                    if (results.some(r => r.path === targetPath))
                        return;
                    // Check direction
                    // We need to check resolvedLinks again to know the direction
                    const outgoing = ((_a = resolvedLinks[sourcePath]) === null || _a === void 0 ? void 0 : _a[targetPath]) !== undefined;
                    const incoming = ((_b = resolvedLinks[targetPath]) === null || _b === void 0 ? void 0 : _b[sourcePath]) !== undefined;
                    let shouldInclude = false;
                    if (outgoing && this.settings.showOutgoingLinks)
                        shouldInclude = true;
                    if (incoming && this.settings.showBacklinks)
                        shouldInclude = true;
                    if (shouldInclude) {
                        results.push({
                            path: targetPath,
                            score: 0,
                            commonNeighbors: []
                        });
                    }
                });
            }
        }
        // 3. Sort
        return results.sort((a, b) => b.score - a.score);
    }
}

const VIEW_TYPE_ATOMIC_INSIGHTS = 'atomic-insights-view';
class AtomicInsightsView extends obsidian.ItemView {
    constructor(leaf, plugin) {
        super(leaf);
        this.currentFilePath = null;
        this.plugin = plugin;
        this.adamicAdar = new AdamicAdar(plugin.app, plugin.settings);
    }
    getViewType() {
        return VIEW_TYPE_ATOMIC_INSIGHTS;
    }
    getDisplayText() {
        return 'Atomic Insights';
    }
    getIcon() {
        return 'atomic-insights';
    }
    onOpen() {
        return __awaiter(this, void 0, void 0, function* () {
            this.update();
            // Register event for file switch
            this.registerEvent(this.app.workspace.on('file-open', (file) => {
                if (file) {
                    this.update(file.path);
                }
            }));
            // Also listen to active-leaf-change to catch initial load or focus changes
            this.registerEvent(this.app.workspace.on('active-leaf-change', () => {
                this.update();
            }));
        });
    }
    update(filePath) {
        return __awaiter(this, void 0, void 0, function* () {
            // Wait for layout to be ready to ensure active file can be retrieved
            if (!this.app.workspace.layoutReady) {
                this.app.workspace.onLayoutReady(() => this.update(filePath));
                return;
            }
            if (!filePath) {
                const activeFile = this.app.workspace.getActiveFile();
                if (activeFile) {
                    filePath = activeFile.path;
                }
                else {
                    this.renderEmpty();
                    return;
                }
            }
            this.currentFilePath = filePath;
            // Pass fresh settings in case they changed
            this.adamicAdar.settings = this.plugin.settings;
            const results = this.adamicAdar.calculate(filePath);
            this.render(results);
        });
    }
    renderEmpty() {
        const container = this.containerEl.children[1];
        container.empty();
        container.createEl('div', { text: 'No active file selected.', cls: 'graph-analysis-empty' });
    }
    render(results) {
        const container = this.containerEl.children[1];
        container.empty();
        const dataContainer = container.createDiv({ cls: 'graph-analysis-container' });
        // Header
        const header = dataContainer.createDiv({ cls: 'graph-analysis-header' });
        header.createSpan({ text: 'Atomic Insights', cls: 'graph-analysis-title' });
        // Controls Container
        const controls = header.createDiv({ cls: 'graph-analysis-controls' });
        // Decrease nesting visually by flexbox in css if needed, but for now append buttons to header or controls.
        // Let's put buttons in a container to keep them together.
        // Folder Toggle Button
        // Folder Toggle Button
        const folderBtn = controls.createEl('button', {
            cls: 'graph-analysis-control-btn' + (this.plugin.settings.showFolderNames ? ' is-active' : ''),
            title: this.plugin.settings.showFolderNames ? 'Hide Folder Names' : 'Show Folder Names'
        });
        const iconName = this.plugin.settings.showFolderNames ? 'folder-tree' : 'folder';
        obsidian.setIcon(folderBtn, iconName);
        folderBtn.onclick = () => __awaiter(this, void 0, void 0, function* () {
            var _a;
            this.plugin.settings.showFolderNames = !this.plugin.settings.showFolderNames;
            yield this.plugin.saveSettings();
            this.update((_a = this.currentFilePath) !== null && _a !== void 0 ? _a : undefined);
        });
        // Refresh Button
        const refreshBtn = controls.createEl('button', {
            cls: 'graph-analysis-control-btn',
            title: 'Refresh Analysis'
        });
        obsidian.setIcon(refreshBtn, "refresh-cw");
        refreshBtn.onclick = () => { var _a; return this.update((_a = this.currentFilePath) !== null && _a !== void 0 ? _a : undefined); };
        if (results.length === 0) {
            dataContainer.createDiv({ text: 'No results found.', cls: 'graph-analysis-no-results' });
            return;
        }
        const list = dataContainer.createEl('div', { cls: 'graph-analysis-list' });
        results.slice(0, 50).forEach(res => {
            var _a, _b, _c, _d;
            const item = list.createDiv({ cls: 'graph-analysis-item' });
            item.setAttribute('draggable', 'true');
            // Click to open
            item.addEventListener('click', (e) => {
                var _a;
                // Command/Ctrl click for new tab handled by standard logic if we use openLinkText?
                // Actually openLinkText behavior with modifiers is a bit manual, let's try standard.
                const newLeaf = e.metaKey || e.ctrlKey;
                this.app.workspace.openLinkText(res.path, (_a = this.currentFilePath) !== null && _a !== void 0 ? _a : '', newLeaf);
            });
            // Drag & Drop
            // Drag & Drop
            item.addEventListener('dragstart', (e) => {
                var _a;
                if (e.dataTransfer) {
                    const file = this.app.metadataCache.getFirstLinkpathDest(res.path, "");
                    if (file) {
                        const linkText = this.app.fileManager.generateMarkdownLink(file, (_a = this.currentFilePath) !== null && _a !== void 0 ? _a : '');
                        e.dataTransfer.setData('text/plain', linkText);
                        e.dataTransfer.effectAllowed = 'copy';
                    }
                }
            });
            // Hover Preview
            item.addEventListener('mouseover', (event) => {
                var _a;
                this.app.workspace.trigger('hover-link', {
                    event,
                    source: VIEW_TYPE_ATOMIC_INSIGHTS,
                    hoverParent: this,
                    targetEl: item,
                    linktext: res.path,
                    sourcePath: (_a = this.currentFilePath) !== null && _a !== void 0 ? _a : ''
                });
            });
            // Visuals
            const scorePercent = Math.min(100, Math.round(res.score * 10)); // Arbitrary scale for visibility
            // Name
            item.style.display = 'flex'; // Ensure item is flex container
            item.style.alignItems = 'center'; // Center icon vertically against the block
            // 1. Link Direction Logic (Determine first)
            let iconName = null;
            let title = '';
            if (this.currentFilePath) {
                const resolvedLinks = this.app.metadataCache.resolvedLinks;
                const outgoing = ((_a = resolvedLinks[this.currentFilePath]) === null || _a === void 0 ? void 0 : _a[res.path]) !== undefined;
                const incoming = ((_b = resolvedLinks[res.path]) === null || _b === void 0 ? void 0 : _b[this.currentFilePath]) !== undefined;
                if (outgoing && incoming) {
                    iconName = 'arrow-right-left';
                    title = 'Bidirectional link';
                }
                else if (outgoing) {
                    iconName = 'arrow-right';
                    title = 'Outgoing link';
                }
                else if (incoming) {
                    iconName = 'arrow-left';
                    title = 'Backlink';
                }
            }
            // 2. Create Icon Container (Left Column)
            const iconContainer = item.createDiv({ cls: 'atomic-insights-icon-container' });
            // Since we are now using flex-row for the ITEM, this container sits on the left.
            // We need to ensure the alignment matches the "block" concept.
            // If the user wants it outside the "Title + Graph" block, vertical centering is usually correct.
            if (iconName) {
                iconContainer.title = title;
                obsidian.setIcon(iconContainer, iconName);
                if (iconContainer.innerHTML === '' && iconName === 'arrow-right-left') {
                    obsidian.setIcon(iconContainer, 'switch');
                    if (iconContainer.innerHTML === '') {
                        obsidian.setIcon(iconContainer, 'arrow-up-down');
                    }
                }
            }
            // 3. Create Content Container (Right Column: Title + Bar)
            const contentContainer = item.createDiv({ cls: 'graph-analysis-content-container' });
            contentContainer.style.flexGrow = '1';
            contentContainer.style.display = 'flex';
            contentContainer.style.flexDirection = 'column';
            contentContainer.style.overflow = 'hidden'; // prevent text overflow issues
            // Name
            const nameEl = contentContainer.createDiv({ cls: 'graph-analysis-item-name' });
            // nameEl is just text now, no icon inside.
            nameEl.style.display = 'block'; // Reset to block if inherited styles interfere (though typically div is block)
            nameEl.style.marginBottom = '2px'; // Restore some spacing above bar
            const displayName = this.plugin.settings.showFolderNames
                ? res.path.replace('.md', '')
                : (_d = (_c = res.path.split('/').pop()) === null || _c === void 0 ? void 0 : _c.replace('.md', '')) !== null && _d !== void 0 ? _d : res.path;
            nameEl.innerText = displayName;
            // Score Bar
            const barContainer = contentContainer.createDiv({ cls: 'graph-analysis-item-bar-container' });
            const bar = barContainer.createDiv({ cls: 'graph-analysis-item-bar' });
            bar.style.width = `${scorePercent}%`;
            bar.title = `Score: ${res.score.toFixed(2)}`;
        });
    }
    onClose() {
        return __awaiter(this, void 0, void 0, function* () {
            // Nothing to cleanup
        });
    }
}

const DEFAULT_SETTINGS = {
    excludedFolders: '',
    showFolderNames: false,
    showRelatedNotes: true,
    replaceNativeBacklinks: false,
    showBacklinks: true,
    showOutgoingLinks: true,
};
class AtomicInsightsSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        const { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Atomic Insights Settings' });
        new obsidian.Setting(containerEl)
            .setName('Show Related Notes')
            .setDesc('Show related notes at the bottom of the current note.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.showRelatedNotes)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.showRelatedNotes = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Replace native backlinks')
            .setDesc('Hide the native Obsidian backlinks view and reset editor padding.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.replaceNativeBacklinks)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.replaceNativeBacklinks = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Show Backlinks')
            .setDesc('Include directly linked notes (Backlinks) in the matching results.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.showBacklinks)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.showBacklinks = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Show Outgoing Links')
            .setDesc('Include directly linked notes (Outgoing) in the matching results.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.showOutgoingLinks)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.showOutgoingLinks = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Excluded Folders')
            .setDesc('One folder path per line. Notes in these folders will be ignored.')
            .addTextArea(text => text
            .setPlaceholder('Templates\nArchive')
            .setValue(this.plugin.settings.excludedFolders)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.excludedFolders = value;
            yield this.plugin.saveSettings();
        })));
    }
}

class RelatedNotesView {
    constructor(plugin) {
        this.container = null;
        this.currentFile = null;
        this.plugin = plugin;
        this.adamicAdar = new AdamicAdar(plugin.app, plugin.settings);
    }
    update(leaf) {
        if (!this.plugin.settings.showRelatedNotes) {
            this.remove();
            return;
        }
        if (!(leaf.view instanceof obsidian.MarkdownView)) {
            return;
        }
        const view = leaf.view;
        const file = view.file;
        if (!file) {
            return;
        }
        // If checking same file and container exists, maybe just return?
        // But we might want to re-run analysis if content changed? 
        // For now, let's re-render on active-leaf-change to be safe, 
        // or optimized later if too heavy.
        this.currentFile = file;
        this.render(view, file);
    }
    remove() {
        if (this.container) {
            this.container.remove();
            this.container = null;
        }
    }
    render(view, file) {
        // Determine the correct parent element based on view mode (Source/Live Preview vs Reading View)
        let parent = null;
        const mode = view.getMode(); // 'source' or 'preview'
        if (mode === 'source') {
            // In Live Preview/Source mode, content is managed by CodeMirror.
            // The structure is usually .cm-scroller -> .cm-sizer -> .cm-content
            // To position at the bottom of the content properly, we should inject into .cm-sizer
            // Reference: native embedded-backlinks appears to be inside .cm-sizer
            parent = view.contentEl.querySelector('.cm-sizer');
            // Fallback to scroller if sizer is not found (though it should be there in CM6)
            if (!parent) {
                parent = view.contentEl.querySelector('.cm-scroller');
            }
        }
        else {
            // In Reading View (Preview), content is in .markdown-preview-sizer
            // Structure: .markdown-preview-view -> .markdown-preview-sizer
            parent = view.contentEl.querySelector('.markdown-preview-sizer');
        }
        // Fallback or safety check
        if (!parent) {
            // It might be possible DOM isn't fully ready or structure is different
            console.log('Atomic Insights: Could not find parent container for mode:', mode);
            return;
        }
        // Remove from old location if mode changed or just to be safe (unique DOM ID/Class validation)
        const existingFooter = view.contentEl.querySelector('.atomic-insights-footer');
        if (existingFooter && existingFooter.parentElement !== parent) {
            existingFooter.remove();
        }
        // Check if we already have our footer in the CORRECT parent
        let footer = parent.querySelector(':scope > .atomic-insights-footer');
        if (!footer) {
            footer = parent.createDiv({ cls: 'atomic-insights-footer' });
        }
        footer.empty();
        // Run Analysis
        const results = this.adamicAdar.calculate(file.path);
        // Render Header & Controls
        const headerContainer = footer.createDiv({ cls: 'atomic-insights-header-container' });
        headerContainer.createEl('h6', { text: 'Related notes', cls: 'atomic-insights-header' });
        // Controls
        const controls = headerContainer.createDiv({ cls: 'atomic-insights-controls' });
        const folderBtn = controls.createEl('button', {
            cls: 'atomic-insights-control-btn' + (this.plugin.settings.showFolderNames ? ' is-active' : ''),
            title: this.plugin.settings.showFolderNames ? 'Hide Folder Names' : 'Show Folder Names'
        });
        const iconName = this.plugin.settings.showFolderNames ? 'folder-tree' : 'folder';
        obsidian.setIcon(folderBtn, iconName);
        folderBtn.onclick = () => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.showFolderNames = !this.plugin.settings.showFolderNames;
            yield this.plugin.saveSettings();
            // Re-render
            this.render(view, file);
        });
        // Render List
        const listContainer = footer.createDiv({ cls: 'atomic-insights-list' });
        if (results.length === 0) {
            listContainer.createDiv({ cls: 'atomic-insights-empty', text: 'No strongly related notes found.' });
        }
        else {
            // Show top 10
            const topResults = results.slice(0, 10);
            topResults.forEach(res => {
                var _a, _b, _c, _d;
                const item = listContainer.createDiv({ cls: 'atomic-insights-item' });
                const displayName = this.plugin.settings.showFolderNames
                    ? res.path.replace('.md', '')
                    : (_b = (_a = res.path.split('/').pop()) === null || _a === void 0 ? void 0 : _a.replace('.md', '')) !== null && _b !== void 0 ? _b : res.path;
                // Link
                const link = item.createEl('a', {
                    cls: 'internal-link',
                    text: displayName,
                    href: res.path
                });
                // Click handling
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.plugin.app.workspace.openLinkText(res.path, file.path);
                });
                // Link Direction Logic
                const resolvedLinks = this.plugin.app.metadataCache.resolvedLinks;
                const outgoing = ((_c = resolvedLinks[file.path]) === null || _c === void 0 ? void 0 : _c[res.path]) !== undefined;
                const incoming = ((_d = resolvedLinks[res.path]) === null || _d === void 0 ? void 0 : _d[file.path]) !== undefined;
                let iconName = null;
                let title = '';
                if (outgoing && incoming) {
                    iconName = 'arrow-right-left'; // Try standard lucide first
                    title = 'Bidirectional link';
                }
                else if (outgoing) {
                    iconName = 'arrow-right';
                    title = 'Outgoing link';
                }
                else if (incoming) {
                    iconName = 'arrow-left';
                    title = 'Backlink';
                }
                // Create Icon Container specifically AT THE START
                const iconContainer = item.createDiv({ cls: 'atomic-insights-icon-container' });
                if (iconName) {
                    iconContainer.title = title;
                    obsidian.setIcon(iconContainer, iconName);
                    // Fallback check: if setIcon didn't produce an svg (e.g. icon not found), try backup
                    if (iconContainer.innerHTML === '' && iconName === 'arrow-right-left') {
                        obsidian.setIcon(iconContainer, 'switch'); // Backup for bidirectional
                        if (iconContainer.innerHTML === '') {
                            obsidian.setIcon(iconContainer, 'arrow-up-down'); // Final backup
                        }
                    }
                }
                // Re-order: Icon -> Link -> Score
                // Since we appended Link earlier, we need to adjust or re-append. 
                // Actually, in the code above, 'link' was created BEFORE this logic (line 135).
                // We should INSERT the iconContainer at the beginning.
                item.prepend(iconContainer);
                // Score
                const details = item.createSpan({ cls: 'atomic-insights-score' });
                details.setText(` (Score: ${res.score.toFixed(2)})`);
            });
        }
    }
}

class AtomicInsightsPlugin extends obsidian.Plugin {
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Loading Atomic Insights');
            yield this.loadSettings();
            this.relatedNotesView = new RelatedNotesView(this);
            // Custom Icon: Atomic Network
            // A central core with 3 orbiting nodes connected by lines
            obsidian.addIcon('atomic-insights', `
            <circle cx="50" cy="50" r="14" fill="currentColor" />
            <circle cx="20" cy="20" r="8" fill="currentColor" />
            <circle cx="80" cy="20" r="8" fill="currentColor" />
            <circle cx="50" cy="85" r="8" fill="currentColor" />
            <line x1="50" y1="50" x2="20" y2="20" stroke="currentColor" stroke-width="6" />
            <line x1="50" y1="50" x2="80" y2="20" stroke="currentColor" stroke-width="6" />
            <line x1="50" y1="50" x2="50" y2="85" stroke="currentColor" stroke-width="6" />
        `);
            this.registerView(VIEW_TYPE_ATOMIC_INSIGHTS, (leaf) => new AtomicInsightsView(leaf, this));
            // Ribbon Icon
            this.addRibbonIcon('atomic-insights', 'Atomic Insights', () => {
                this.activateView();
            });
            this.addCommand({
                id: 'open-atomic-insights',
                name: 'Open Atomic Insights View',
                callback: () => {
                    this.activateView();
                },
            });
            this.addSettingTab(new AtomicInsightsSettingTab(this.app, this));
            // Listen for leaf changes to update the related notes footer
            this.registerEvent(this.app.workspace.on('active-leaf-change', (leaf) => {
                if (leaf)
                    this.relatedNotesView.update(leaf);
            }));
            // Initial check for active leaf
            this.app.workspace.onLayoutReady(() => {
                const activeLeaf = this.app.workspace.getMostRecentLeaf();
                if (activeLeaf) {
                    this.relatedNotesView.update(activeLeaf);
                }
                this.updateBodyClass();
            });
        });
    }
    onunload() {
        console.log('Unloading Atomic Insights');
        document.body.classList.remove('atomic-insights-replace-native');
        // Clean up footer from all leaves if necessary
        // Ideally we iterate leaves, but simply letting them be destroyed/removed by GC or manual navigation is okay 
        // if we are cautious. But strictly specific cleanup:
        this.app.workspace.iterateAllLeaves((leaf) => {
            // We can't easily access the specific DOM element without re-querying
            const view = leaf.view;
            if (view instanceof obsidian.MarkdownView) {
                const footer = view.contentEl.querySelector('.atomic-insights-footer');
                if (footer)
                    footer.remove();
            }
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
            this.updateBodyClass();
            // Refresh view for active leaf
            const activeLeaf = this.app.workspace.getMostRecentLeaf();
            if (activeLeaf) {
                this.relatedNotesView.update(activeLeaf);
            }
        });
    }
    updateBodyClass() {
        if (this.settings.replaceNativeBacklinks) {
            document.body.classList.add('atomic-insights-replace-native');
        }
        else {
            document.body.classList.remove('atomic-insights-replace-native');
        }
    }
    activateView() {
        return __awaiter(this, void 0, void 0, function* () {
            const { workspace } = this.app;
            let leaf = null;
            const leaves = workspace.getLeavesOfType(VIEW_TYPE_ATOMIC_INSIGHTS);
            if (leaves.length > 0) {
                leaf = leaves[0];
            }
            else {
                leaf = workspace.getRightLeaf(false);
                if (leaf) {
                    yield leaf.setViewState({
                        type: VIEW_TYPE_ATOMIC_INSIGHTS,
                        active: true,
                    });
                }
            }
            if (leaf) {
                workspace.revealLeaf(leaf);
            }
        });
    }
}

module.exports = AtomicInsightsPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsInNyYy9BZGFtaWNBZGFyLnRzIiwic3JjL0FuYWx5c2lzVmlldy50cyIsInNyYy9TZXR0aW5ncy50cyIsInNyYy9SZWxhdGVkTm90ZXNWaWV3LnRzIiwic3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOm51bGwsIm5hbWVzIjpbIkl0ZW1WaWV3Iiwic2V0SWNvbiIsIlBsdWdpblNldHRpbmdUYWIiLCJTZXR0aW5nIiwiTWFya2Rvd25WaWV3IiwiUGx1Z2luIiwiYWRkSWNvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXVEQTtBQUNPLFNBQVMsU0FBUyxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRTtBQUM3RCxJQUFJLFNBQVMsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLE9BQU8sS0FBSyxZQUFZLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUMsVUFBVSxPQUFPLEVBQUUsRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRTtBQUNoSCxJQUFJLE9BQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU0sRUFBRTtBQUMvRCxRQUFRLFNBQVMsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7QUFDbkcsUUFBUSxTQUFTLFFBQVEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7QUFDdEcsUUFBUSxTQUFTLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDLEVBQUU7QUFDdEgsUUFBUSxJQUFJLENBQUMsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsVUFBVSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7QUFDOUUsS0FBSyxDQUFDLENBQUM7QUFDUDs7TUNwRWEsVUFBVTtJQUluQixZQUFZLEdBQVEsRUFBRSxRQUFnQztRQUNsRCxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztRQUNmLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO0tBQzVCO0lBRU0sU0FBUyxDQUFDLFVBQWtCO1FBQy9CLE1BQU0sRUFBRSxhQUFhLEVBQUUsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQzs7UUFHakQsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlO2FBQzlDLEtBQUssQ0FBQyxJQUFJLENBQUM7YUFDWCxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQzthQUNsQixNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFL0IsTUFBTSxVQUFVLEdBQUcsQ0FBQyxJQUFZO1lBQzVCLE9BQU8sYUFBYSxDQUFDLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1NBQ2hFLENBQUM7UUFFRixJQUFJLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUczQjtRQUVELE1BQU0sU0FBUyxHQUFnQyxFQUFFLENBQUM7UUFDbEQsTUFBTSxPQUFPLEdBQTJCLEVBQUUsQ0FBQzs7UUFHM0MsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFTLEVBQUUsQ0FBUztZQUNqQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztnQkFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxHQUFHLEVBQUUsQ0FBQztZQUM1QyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztnQkFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxHQUFHLEVBQUUsQ0FBQztZQUM1QyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3BCLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDdkIsQ0FBQzs7OztRQUtGLEtBQUssTUFBTSxNQUFNLElBQUksYUFBYSxFQUFFO1lBQ2hDLElBQUksVUFBVSxDQUFDLE1BQU0sQ0FBQztnQkFBRSxTQUFTO1lBRWpDLE1BQU0sT0FBTyxHQUFHLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN0QyxLQUFLLE1BQU0sTUFBTSxJQUFJLE9BQU8sRUFBRTtnQkFDMUIsSUFBSSxVQUFVLENBQUMsTUFBTSxDQUFDO29CQUFFLFNBQVM7Z0JBQ2pDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7YUFDM0I7U0FDSjs7UUFHRCxLQUFLLE1BQU0sSUFBSSxJQUFJLFNBQVMsRUFBRTtZQUMxQixPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQztTQUN4Qzs7UUFHRCxNQUFNLGVBQWUsR0FBRyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLGVBQWU7WUFBRSxPQUFPLEVBQUUsQ0FBQztRQUVoQyxNQUFNLE9BQU8sR0FBcUIsRUFBRSxDQUFDO1FBRXJDLEtBQUssTUFBTSxVQUFVLElBQUksU0FBUyxFQUFFO1lBQ2hDLElBQUksVUFBVSxLQUFLLFVBQVU7Z0JBQUUsU0FBUztZQUV4QyxNQUFNLGVBQWUsR0FBRyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDOUMsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO1lBQ2QsTUFBTSxXQUFXLEdBQWEsRUFBRSxDQUFDOztZQUdqQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ3JCLElBQUksZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRTtvQkFDeEIsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDcEIsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUMxQixJQUFJLE1BQU0sR0FBRyxDQUFDLEVBQUU7d0JBQ1osS0FBSyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO3FCQUNqQztpQkFDSjthQUNKLENBQUMsQ0FBQztZQUVILElBQUksS0FBSyxHQUFHLENBQUMsRUFBRTtnQkFDWCxPQUFPLENBQUMsSUFBSSxDQUFDO29CQUNULElBQUksRUFBRSxVQUFVO29CQUNoQixLQUFLLEVBQUUsS0FBSztvQkFDWixlQUFlLEVBQUUsV0FBVztpQkFDL0IsQ0FBQyxDQUFDO2FBQ047U0FDSjs7UUFHRCxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsaUJBQWlCLEVBQUU7O1lBRWhFLE1BQU0sZUFBZSxHQUFHLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUU5QyxJQUFJLGVBQWUsRUFBRTtnQkFDakIsZUFBZSxDQUFDLE9BQU8sQ0FBQyxVQUFVOztvQkFDOUIsSUFBSSxVQUFVLENBQUMsVUFBVSxDQUFDO3dCQUFFLE9BQU87O29CQUduQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUssVUFBVSxDQUFDO3dCQUFFLE9BQU87OztvQkFJckQsTUFBTSxRQUFRLEdBQUcsQ0FBQSxNQUFBLGFBQWEsQ0FBQyxVQUFVLENBQUMsMENBQUcsVUFBVSxDQUFDLE1BQUssU0FBUyxDQUFDO29CQUN2RSxNQUFNLFFBQVEsR0FBRyxDQUFBLE1BQUEsYUFBYSxDQUFDLFVBQVUsQ0FBQywwQ0FBRyxVQUFVLENBQUMsTUFBSyxTQUFTLENBQUM7b0JBRXZFLElBQUksYUFBYSxHQUFHLEtBQUssQ0FBQztvQkFDMUIsSUFBSSxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxpQkFBaUI7d0JBQUUsYUFBYSxHQUFHLElBQUksQ0FBQztvQkFDdEUsSUFBSSxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhO3dCQUFFLGFBQWEsR0FBRyxJQUFJLENBQUM7b0JBRWxFLElBQUksYUFBYSxFQUFFO3dCQUNmLE9BQU8sQ0FBQyxJQUFJLENBQUM7NEJBQ1QsSUFBSSxFQUFFLFVBQVU7NEJBQ2hCLEtBQUssRUFBRSxDQUFDOzRCQUNSLGVBQWUsRUFBRSxFQUFFO3lCQUN0QixDQUFDLENBQUM7cUJBQ047aUJBQ0osQ0FBQyxDQUFDO2FBQ047U0FDSjs7UUFHRCxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ3BEOzs7QUNoSUUsTUFBTSx5QkFBeUIsR0FBRyxzQkFBc0IsQ0FBQztNQUVuRCxrQkFBbUIsU0FBUUEsaUJBQVE7SUFLNUMsWUFBWSxJQUFtQixFQUFFLE1BQTRCO1FBQ3pELEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUhoQixvQkFBZSxHQUFrQixJQUFJLENBQUM7UUFJbEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLFVBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUNqRTtJQUVELFdBQVc7UUFDUCxPQUFPLHlCQUF5QixDQUFDO0tBQ3BDO0lBRUQsY0FBYztRQUNWLE9BQU8saUJBQWlCLENBQUM7S0FDNUI7SUFFRCxPQUFPO1FBQ0gsT0FBTyxpQkFBaUIsQ0FBQztLQUM1QjtJQUVLLE1BQU07O1lBQ1IsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDOztZQUVkLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUk7Z0JBQ3ZELElBQUksSUFBSSxFQUFFO29CQUNOLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUMxQjthQUNKLENBQUMsQ0FBQyxDQUFDOztZQUdKLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLG9CQUFvQixFQUFFO2dCQUMzRCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7YUFDakIsQ0FBQyxDQUFDLENBQUM7U0FDUDtLQUFBO0lBRUssTUFBTSxDQUFDLFFBQWlCOzs7WUFFMUIsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRTtnQkFDakMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO2dCQUM5RCxPQUFPO2FBQ1Y7WUFFRCxJQUFJLENBQUMsUUFBUSxFQUFFO2dCQUNYLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLGFBQWEsRUFBRSxDQUFDO2dCQUN0RCxJQUFJLFVBQVUsRUFBRTtvQkFDWixRQUFRLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQztpQkFDOUI7cUJBQU07b0JBQ0gsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO29CQUNuQixPQUFPO2lCQUNWO2FBQ0o7WUFFRCxJQUFJLENBQUMsZUFBZSxHQUFHLFFBQVEsQ0FBQzs7WUFHaEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUM7WUFFaEQsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDcEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUN4QjtLQUFBO0lBRUQsV0FBVztRQUNQLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQy9DLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNsQixTQUFTLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSwwQkFBMEIsRUFBRSxHQUFHLEVBQUUsc0JBQXNCLEVBQUUsQ0FBQyxDQUFDO0tBQ2hHO0lBRUQsTUFBTSxDQUFDLE9BQXlCO1FBQzVCLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQy9DLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUVsQixNQUFNLGFBQWEsR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLDBCQUEwQixFQUFFLENBQUMsQ0FBQzs7UUFHL0UsTUFBTSxNQUFNLEdBQUcsYUFBYSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSx1QkFBdUIsRUFBRSxDQUFDLENBQUM7UUFDekUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLElBQUksRUFBRSxpQkFBaUIsRUFBRSxHQUFHLEVBQUUsc0JBQXNCLEVBQUUsQ0FBQyxDQUFDOztRQUc1RSxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLHlCQUF5QixFQUFFLENBQUMsQ0FBQzs7Ozs7UUFPdEUsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUU7WUFDMUMsR0FBRyxFQUFFLDRCQUE0QixJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGVBQWUsR0FBRyxZQUFZLEdBQUcsRUFBRSxDQUFDO1lBQzlGLEtBQUssRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxlQUFlLEdBQUcsbUJBQW1CLEdBQUcsbUJBQW1CO1NBQzFGLENBQUMsQ0FBQztRQUVILE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGVBQWUsR0FBRyxhQUFhLEdBQUcsUUFBUSxDQUFDO1FBQ2pGQyxnQkFBTyxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUU3QixTQUFTLENBQUMsT0FBTyxHQUFHOztZQUNoQixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxlQUFlLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUM7WUFDN0UsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ2pDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBQSxJQUFJLENBQUMsZUFBZSxtQ0FBSSxTQUFTLENBQUMsQ0FBQztTQUNsRCxDQUFBLENBQUM7O1FBR0YsTUFBTSxVQUFVLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUU7WUFDM0MsR0FBRyxFQUFFLDRCQUE0QjtZQUNqQyxLQUFLLEVBQUUsa0JBQWtCO1NBQzVCLENBQUMsQ0FBQztRQUNIQSxnQkFBTyxDQUFDLFVBQVUsRUFBRSxZQUFZLENBQUMsQ0FBQztRQUNsQyxVQUFVLENBQUMsT0FBTyxHQUFHLGdCQUFNLE9BQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFBLElBQUksQ0FBQyxlQUFlLG1DQUFJLFNBQVMsQ0FBQyxDQUFBLEVBQUEsQ0FBQztRQUUxRSxJQUFJLE9BQU8sQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ3RCLGFBQWEsQ0FBQyxTQUFTLENBQUMsRUFBRSxJQUFJLEVBQUUsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLDJCQUEyQixFQUFFLENBQUMsQ0FBQztZQUN6RixPQUFPO1NBQ1Y7UUFFRCxNQUFNLElBQUksR0FBRyxhQUFhLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLEdBQUcsRUFBRSxxQkFBcUIsRUFBRSxDQUFDLENBQUM7UUFFM0UsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUc7O1lBQzVCLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUscUJBQXFCLEVBQUUsQ0FBQyxDQUFDO1lBQzVELElBQUksQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDOztZQUd2QyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQzs7OztnQkFHN0IsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLE9BQU8sSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDO2dCQUN2QyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxNQUFBLElBQUksQ0FBQyxlQUFlLG1DQUFJLEVBQUUsRUFBRSxPQUFPLENBQUMsQ0FBQzthQUNsRixDQUFDLENBQUM7OztZQUlILElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDOztnQkFDakMsSUFBSSxDQUFDLENBQUMsWUFBWSxFQUFFO29CQUNoQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO29CQUN2RSxJQUFJLElBQUksRUFBRTt3QkFDTixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLEVBQUUsTUFBQSxJQUFJLENBQUMsZUFBZSxtQ0FBSSxFQUFFLENBQUMsQ0FBQzt3QkFDN0YsQ0FBQyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO3dCQUMvQyxDQUFDLENBQUMsWUFBWSxDQUFDLGFBQWEsR0FBRyxNQUFNLENBQUM7cUJBQ3pDO2lCQUNKO2FBQ0osQ0FBQyxDQUFDOztZQUdILElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxLQUFLOztnQkFDckMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRTtvQkFDckMsS0FBSztvQkFDTCxNQUFNLEVBQUUseUJBQXlCO29CQUNqQyxXQUFXLEVBQUUsSUFBSTtvQkFDakIsUUFBUSxFQUFFLElBQUk7b0JBQ2QsUUFBUSxFQUFFLEdBQUcsQ0FBQyxJQUFJO29CQUNsQixVQUFVLEVBQUUsTUFBQSxJQUFJLENBQUMsZUFBZSxtQ0FBSSxFQUFFO2lCQUN6QyxDQUFDLENBQUM7YUFDTixDQUFDLENBQUM7O1lBR0gsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7O1lBRy9ELElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztZQUM1QixJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyxRQUFRLENBQUM7O1lBR2pDLElBQUksUUFBUSxHQUFrQixJQUFJLENBQUM7WUFDbkMsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO1lBRWYsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO2dCQUN0QixNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUM7Z0JBQzNELE1BQU0sUUFBUSxHQUFHLENBQUEsTUFBQSxhQUFhLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQywwQ0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQUssU0FBUyxDQUFDO2dCQUMvRSxNQUFNLFFBQVEsR0FBRyxDQUFBLE1BQUEsYUFBYSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsMENBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFLLFNBQVMsQ0FBQztnQkFFL0UsSUFBSSxRQUFRLElBQUksUUFBUSxFQUFFO29CQUN0QixRQUFRLEdBQUcsa0JBQWtCLENBQUM7b0JBQzlCLEtBQUssR0FBRyxvQkFBb0IsQ0FBQztpQkFDaEM7cUJBQU0sSUFBSSxRQUFRLEVBQUU7b0JBQ2pCLFFBQVEsR0FBRyxhQUFhLENBQUM7b0JBQ3pCLEtBQUssR0FBRyxlQUFlLENBQUM7aUJBQzNCO3FCQUFNLElBQUksUUFBUSxFQUFFO29CQUNqQixRQUFRLEdBQUcsWUFBWSxDQUFDO29CQUN4QixLQUFLLEdBQUcsVUFBVSxDQUFDO2lCQUN0QjthQUNKOztZQUdELE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsZ0NBQWdDLEVBQUUsQ0FBQyxDQUFDOzs7O1lBS2hGLElBQUksUUFBUSxFQUFFO2dCQUNWLGFBQWEsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO2dCQUM1QkEsZ0JBQU8sQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDLENBQUM7Z0JBRWpDLElBQUksYUFBYSxDQUFDLFNBQVMsS0FBSyxFQUFFLElBQUksUUFBUSxLQUFLLGtCQUFrQixFQUFFO29CQUNuRUEsZ0JBQU8sQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDLENBQUM7b0JBQ2pDLElBQUksYUFBYSxDQUFDLFNBQVMsS0FBSyxFQUFFLEVBQUU7d0JBQ2hDQSxnQkFBTyxDQUFDLGFBQWEsRUFBRSxlQUFlLENBQUMsQ0FBQztxQkFDM0M7aUJBQ0o7YUFDSjs7WUFHRCxNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsa0NBQWtDLEVBQUUsQ0FBQyxDQUFDO1lBQ3JGLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDO1lBQ3RDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1lBQ3hDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxhQUFhLEdBQUcsUUFBUSxDQUFDO1lBQ2hELGdCQUFnQixDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDOztZQUczQyxNQUFNLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsMEJBQTBCLEVBQUUsQ0FBQyxDQUFDOztZQUUvRSxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7WUFDL0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDO1lBRWxDLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGVBQWU7a0JBQ2xELEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUM7a0JBQzNCLE1BQUEsTUFBQSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsMENBQUUsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsbUNBQUksR0FBRyxDQUFDLElBQUksQ0FBQztZQUVoRSxNQUFNLENBQUMsU0FBUyxHQUFHLFdBQVcsQ0FBQzs7WUFHL0IsTUFBTSxZQUFZLEdBQUcsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLG1DQUFtQyxFQUFFLENBQUMsQ0FBQztZQUM5RixNQUFNLEdBQUcsR0FBRyxZQUFZLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLHlCQUF5QixFQUFFLENBQUMsQ0FBQztZQUN2RSxHQUFHLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxHQUFHLFlBQVksR0FBRyxDQUFDO1lBQ3JDLEdBQUcsQ0FBQyxLQUFLLEdBQUcsVUFBVSxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1NBQ2hELENBQUMsQ0FBQztLQUNOO0lBRUssT0FBTzs7O1NBRVo7S0FBQTs7O0FDL05FLE1BQU0sZ0JBQWdCLEdBQTJCO0lBQ3BELGVBQWUsRUFBRSxFQUFFO0lBQ25CLGVBQWUsRUFBRSxLQUFLO0lBQ3RCLGdCQUFnQixFQUFFLElBQUk7SUFDdEIsc0JBQXNCLEVBQUUsS0FBSztJQUM3QixhQUFhLEVBQUUsSUFBSTtJQUNuQixpQkFBaUIsRUFBRSxJQUFJO0NBQzFCLENBQUM7TUFFVyx3QkFBeUIsU0FBUUMseUJBQWdCO0lBRzFELFlBQVksR0FBUSxFQUFFLE1BQTRCO1FBQzlDLEtBQUssQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDbkIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7S0FDeEI7SUFFRCxPQUFPO1FBQ0gsTUFBTSxFQUFFLFdBQVcsRUFBRSxHQUFHLElBQUksQ0FBQztRQUM3QixXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDcEIsV0FBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsMEJBQTBCLEVBQUUsQ0FBQyxDQUFDO1FBRWpFLElBQUlDLGdCQUFPLENBQUMsV0FBVyxDQUFDO2FBQ25CLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQzthQUM3QixPQUFPLENBQUMsdURBQXVELENBQUM7YUFDaEUsU0FBUyxDQUFDLE1BQU0sSUFBSSxNQUFNO2FBQ3RCLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQzthQUMvQyxRQUFRLENBQUMsQ0FBTyxLQUFLO1lBQ2xCLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGdCQUFnQixHQUFHLEtBQUssQ0FBQztZQUM5QyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsWUFBWSxFQUFFLENBQUM7U0FDcEMsQ0FBQSxDQUFDLENBQUMsQ0FBQztRQUVaLElBQUlBLGdCQUFPLENBQUMsV0FBVyxDQUFDO2FBQ25CLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQzthQUNuQyxPQUFPLENBQUMsbUVBQW1FLENBQUM7YUFDNUUsU0FBUyxDQUFDLE1BQU0sSUFBSSxNQUFNO2FBQ3RCLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQzthQUNyRCxRQUFRLENBQUMsQ0FBTyxLQUFLO1lBQ2xCLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLHNCQUFzQixHQUFHLEtBQUssQ0FBQztZQUNwRCxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsWUFBWSxFQUFFLENBQUM7U0FDcEMsQ0FBQSxDQUFDLENBQUMsQ0FBQztRQUVaLElBQUlBLGdCQUFPLENBQUMsV0FBVyxDQUFDO2FBQ25CLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQzthQUN6QixPQUFPLENBQUMsb0VBQW9FLENBQUM7YUFDN0UsU0FBUyxDQUFDLE1BQU0sSUFBSSxNQUFNO2FBQ3RCLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUM7YUFDNUMsUUFBUSxDQUFDLENBQU8sS0FBSztZQUNsQixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO1lBQzNDLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUNwQyxDQUFBLENBQUMsQ0FBQyxDQUFDO1FBRVosSUFBSUEsZ0JBQU8sQ0FBQyxXQUFXLENBQUM7YUFDbkIsT0FBTyxDQUFDLHFCQUFxQixDQUFDO2FBQzlCLE9BQU8sQ0FBQyxtRUFBbUUsQ0FBQzthQUM1RSxTQUFTLENBQUMsTUFBTSxJQUFJLE1BQU07YUFDdEIsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDO2FBQ2hELFFBQVEsQ0FBQyxDQUFPLEtBQUs7WUFDbEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDO1lBQy9DLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUNwQyxDQUFBLENBQUMsQ0FBQyxDQUFDO1FBRVosSUFBSUEsZ0JBQU8sQ0FBQyxXQUFXLENBQUM7YUFDbkIsT0FBTyxDQUFDLGtCQUFrQixDQUFDO2FBQzNCLE9BQU8sQ0FBQyxtRUFBbUUsQ0FBQzthQUM1RSxXQUFXLENBQUMsSUFBSSxJQUFJLElBQUk7YUFDcEIsY0FBYyxDQUFDLG9CQUFvQixDQUFDO2FBQ3BDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUM7YUFDOUMsUUFBUSxDQUFDLENBQU8sS0FBSztZQUNsQixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxlQUFlLEdBQUcsS0FBSyxDQUFDO1lBQzdDLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUNwQyxDQUFBLENBQUMsQ0FBQyxDQUFDO0tBQ2Y7OztNQ2hGUSxnQkFBZ0I7SUFNekIsWUFBWSxNQUE0QjtRQUh4QyxjQUFTLEdBQXVCLElBQUksQ0FBQztRQUNyQyxnQkFBVyxHQUFpQixJQUFJLENBQUM7UUFHN0IsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLFVBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUNqRTtJQUVELE1BQU0sQ0FBQyxJQUFtQjtRQUN0QixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLEVBQUU7WUFDeEMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2QsT0FBTztTQUNWO1FBRUQsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLFlBQVlDLHFCQUFZLENBQUMsRUFBRTtZQUN0QyxPQUFPO1NBQ1Y7UUFFRCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBb0IsQ0FBQztRQUN2QyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBRXZCLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDUCxPQUFPO1NBQ1Y7Ozs7O1FBT0QsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7UUFDeEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDM0I7SUFFRCxNQUFNO1FBQ0YsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQ2hCLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDeEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7U0FDekI7S0FDSjtJQUVPLE1BQU0sQ0FBQyxJQUFrQixFQUFFLElBQVc7O1FBRTFDLElBQUksTUFBTSxHQUF1QixJQUFJLENBQUM7UUFDdEMsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBRTVCLElBQUksSUFBSSxLQUFLLFFBQVEsRUFBRTs7Ozs7WUFLbkIsTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDOztZQUduRCxJQUFJLENBQUMsTUFBTSxFQUFFO2dCQUNULE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQzthQUN6RDtTQUNKO2FBQU07OztZQUdILE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1NBQ3BFOztRQUdELElBQUksQ0FBQyxNQUFNLEVBQUU7O1lBRVQsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0REFBNEQsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNoRixPQUFPO1NBQ1Y7O1FBR0QsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMseUJBQXlCLENBQUMsQ0FBQztRQUMvRSxJQUFJLGNBQWMsSUFBSSxjQUFjLENBQUMsYUFBYSxLQUFLLE1BQU0sRUFBRTtZQUMzRCxjQUFjLENBQUMsTUFBTSxFQUFFLENBQUM7U0FDM0I7O1FBR0QsSUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQyxrQ0FBa0MsQ0FBZ0IsQ0FBQztRQUVyRixJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ1QsTUFBTSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsd0JBQXdCLEVBQUUsQ0FBQyxDQUFDO1NBQ2hFO1FBRUQsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDOztRQUdmLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzs7UUFHckQsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxrQ0FBa0MsRUFBRSxDQUFDLENBQUM7UUFDdkUsZUFBZSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsZUFBZSxFQUFFLEdBQUcsRUFBRSx3QkFBd0IsRUFBRSxFQUFFOztRQUd4RyxNQUFNLFFBQVEsR0FBRyxlQUFlLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLDBCQUEwQixFQUFFLENBQUMsQ0FBQztRQUVoRixNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRTtZQUMxQyxHQUFHLEVBQUUsNkJBQTZCLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsZUFBZSxHQUFHLFlBQVksR0FBRyxFQUFFLENBQUM7WUFDL0YsS0FBSyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGVBQWUsR0FBRyxtQkFBbUIsR0FBRyxtQkFBbUI7U0FDMUYsQ0FBQyxDQUFDO1FBRUgsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsZUFBZSxHQUFHLGFBQWEsR0FBRyxRQUFRLENBQUM7UUFDakZILGdCQUFPLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBRTdCLFNBQVMsQ0FBQyxPQUFPLEdBQUc7WUFDaEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsZUFBZSxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDO1lBQzdFLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQzs7WUFFakMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDM0IsQ0FBQSxDQUFDOztRQUdGLE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsc0JBQXNCLEVBQUUsQ0FBQyxDQUFDO1FBRXhFLElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDdEIsYUFBYSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSx1QkFBdUIsRUFBRSxJQUFJLEVBQUUsa0NBQWtDLEVBQUUsQ0FBQyxDQUFDO1NBQ3ZHO2FBQU07O1lBRUgsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFFeEMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxHQUFHOztnQkFDbEIsTUFBTSxJQUFJLEdBQUcsYUFBYSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxzQkFBc0IsRUFBRSxDQUFDLENBQUM7Z0JBRXRFLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGVBQWU7c0JBQ2xELEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUM7c0JBQzNCLE1BQUEsTUFBQSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsMENBQUUsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsbUNBQUksR0FBRyxDQUFDLElBQUksQ0FBQzs7Z0JBR2hFLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFO29CQUM1QixHQUFHLEVBQUUsZUFBZTtvQkFDcEIsSUFBSSxFQUFFLFdBQVc7b0JBQ2pCLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSTtpQkFDakIsQ0FBQyxDQUFDOztnQkFHSCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztvQkFDN0IsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO29CQUNuQixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUMvRCxDQUFDLENBQUM7O2dCQUdILE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUM7Z0JBQ2xFLE1BQU0sUUFBUSxHQUFHLENBQUEsTUFBQSxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQywwQ0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQUssU0FBUyxDQUFDO2dCQUNwRSxNQUFNLFFBQVEsR0FBRyxDQUFBLE1BQUEsYUFBYSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsMENBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFLLFNBQVMsQ0FBQztnQkFFcEUsSUFBSSxRQUFRLEdBQWtCLElBQUksQ0FBQztnQkFDbkMsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO2dCQUVmLElBQUksUUFBUSxJQUFJLFFBQVEsRUFBRTtvQkFDdEIsUUFBUSxHQUFHLGtCQUFrQixDQUFDO29CQUM5QixLQUFLLEdBQUcsb0JBQW9CLENBQUM7aUJBQ2hDO3FCQUFNLElBQUksUUFBUSxFQUFFO29CQUNqQixRQUFRLEdBQUcsYUFBYSxDQUFDO29CQUN6QixLQUFLLEdBQUcsZUFBZSxDQUFDO2lCQUMzQjtxQkFBTSxJQUFJLFFBQVEsRUFBRTtvQkFDakIsUUFBUSxHQUFHLFlBQVksQ0FBQztvQkFDeEIsS0FBSyxHQUFHLFVBQVUsQ0FBQztpQkFDdEI7O2dCQUdELE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsZ0NBQWdDLEVBQUUsQ0FBQyxDQUFDO2dCQUVoRixJQUFJLFFBQVEsRUFBRTtvQkFDVixhQUFhLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztvQkFDNUJBLGdCQUFPLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQyxDQUFDOztvQkFHakMsSUFBSSxhQUFhLENBQUMsU0FBUyxLQUFLLEVBQUUsSUFBSSxRQUFRLEtBQUssa0JBQWtCLEVBQUU7d0JBQ25FQSxnQkFBTyxDQUFDLGFBQWEsRUFBRSxRQUFRLENBQUMsQ0FBQzt3QkFDakMsSUFBSSxhQUFhLENBQUMsU0FBUyxLQUFLLEVBQUUsRUFBRTs0QkFDaENBLGdCQUFPLENBQUMsYUFBYSxFQUFFLGVBQWUsQ0FBQyxDQUFDO3lCQUMzQztxQkFDSjtpQkFHSjs7Ozs7Z0JBTUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQzs7Z0JBRzVCLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUUsQ0FBQyxDQUFDO2dCQUNsRSxPQUFPLENBQUMsT0FBTyxDQUFDLFlBQVksR0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ3hELENBQUMsQ0FBQztTQUNOO0tBQ0o7OztNQzdMZ0Isb0JBQXFCLFNBQVFJLGVBQU07SUFJOUMsTUFBTTs7WUFDUixPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFFdkMsTUFBTSxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7WUFFMUIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUM7OztZQUluREMsZ0JBQU8sQ0FBQyxpQkFBaUIsRUFBRTs7Ozs7Ozs7U0FRMUIsQ0FBQyxDQUFDO1lBRUgsSUFBSSxDQUFDLFlBQVksQ0FDYix5QkFBeUIsRUFDekIsQ0FBQyxJQUFtQixLQUFLLElBQUksa0JBQWtCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUM5RCxDQUFDOztZQUdGLElBQUksQ0FBQyxhQUFhLENBQUMsaUJBQWlCLEVBQUUsaUJBQWlCLEVBQUU7Z0JBQ3JELElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQzthQUN2QixDQUFDLENBQUM7WUFFSCxJQUFJLENBQUMsVUFBVSxDQUFDO2dCQUNaLEVBQUUsRUFBRSxzQkFBc0I7Z0JBQzFCLElBQUksRUFBRSwyQkFBMkI7Z0JBQ2pDLFFBQVEsRUFBRTtvQkFDTixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7aUJBQ3ZCO2FBQ0osQ0FBQyxDQUFDO1lBRUgsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLHdCQUF3QixDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQzs7WUFHakUsSUFBSSxDQUFDLGFBQWEsQ0FDZCxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxJQUFJO2dCQUM3QyxJQUFJLElBQUk7b0JBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNoRCxDQUFDLENBQ0wsQ0FBQzs7WUFHRixJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUM7Z0JBQzdCLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLGlCQUFpQixFQUFFLENBQUM7Z0JBQzFELElBQUksVUFBVSxFQUFFO29CQUNaLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7aUJBQzVDO2dCQUNELElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQzthQUMxQixDQUFDLENBQUM7U0FDTjtLQUFBO0lBRUQsUUFBUTtRQUNKLE9BQU8sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUN6QyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsZ0NBQWdDLENBQUMsQ0FBQzs7OztRQUtqRSxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLElBQUk7O1lBRXJDLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7WUFDdkIsSUFBSSxJQUFJLFlBQVlGLHFCQUFZLEVBQUU7Z0JBQzlCLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLHlCQUF5QixDQUFDLENBQUM7Z0JBQ3ZFLElBQUksTUFBTTtvQkFBRSxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7YUFDL0I7U0FDSixDQUFDLENBQUM7S0FDTjtJQUVLLFlBQVk7O1lBQ2QsSUFBSSxDQUFDLFFBQVEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1NBQzlFO0tBQUE7SUFFSyxZQUFZOztZQUNkLE1BQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbkMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDOztZQUd2QixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBQzFELElBQUksVUFBVSxFQUFFO2dCQUNaLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7YUFDNUM7U0FDSjtLQUFBO0lBRUQsZUFBZTtRQUNYLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxzQkFBc0IsRUFBRTtZQUN0QyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztTQUNqRTthQUFNO1lBQ0gsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLGdDQUFnQyxDQUFDLENBQUM7U0FDcEU7S0FDSjtJQUVLLFlBQVk7O1lBQ2QsTUFBTSxFQUFFLFNBQVMsRUFBRSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7WUFFL0IsSUFBSSxJQUFJLEdBQXlCLElBQUksQ0FBQztZQUN0QyxNQUFNLE1BQU0sR0FBRyxTQUFTLENBQUMsZUFBZSxDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFFcEUsSUFBSSxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtnQkFDbkIsSUFBSSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNwQjtpQkFBTTtnQkFDSCxJQUFJLEdBQUcsU0FBUyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDckMsSUFBSSxJQUFJLEVBQUU7b0JBQ04sTUFBTSxJQUFJLENBQUMsWUFBWSxDQUFDO3dCQUNwQixJQUFJLEVBQUUseUJBQXlCO3dCQUMvQixNQUFNLEVBQUUsSUFBSTtxQkFDZixDQUFDLENBQUM7aUJBQ047YUFDSjtZQUVELElBQUksSUFBSSxFQUFFO2dCQUNOLFNBQVMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDOUI7U0FDSjtLQUFBOzs7OzsifQ==
